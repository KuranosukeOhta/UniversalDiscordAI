# è¤‡æ•°ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼åŒæ™‚èµ·å‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€Universal Discord AIã§è¤‡æ•°ã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚’åŒæ™‚ã«ç•°ãªã‚‹BOTã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§èµ·å‹•ã™ã‚‹æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚

## ğŸ“‹ ç›®æ¬¡

1. [æ¦‚è¦](#æ¦‚è¦)
2. [å‰ææ¡ä»¶](#å‰ææ¡ä»¶)
3. [ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †](#ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †)
4. [èµ·å‹•æ–¹æ³•](#èµ·å‹•æ–¹æ³•)
5. [ç®¡ç†ã‚³ãƒãƒ³ãƒ‰](#ç®¡ç†ã‚³ãƒãƒ³ãƒ‰)
6. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)

---

## ğŸ¯ æ¦‚è¦

Docker Composeã‚’ä½¿ç”¨ã—ã¦ã€è¤‡æ•°ã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ï¼ˆfriendly, professionalãªã©ï¼‰ã‚’ãã‚Œãã‚Œç‹¬ç«‹ã—ãŸBOTã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¨ã—ã¦åŒæ™‚èµ·å‹•ã—ã¾ã™ã€‚

### ãƒ¡ãƒªãƒƒãƒˆ

- âœ… å„ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãŒå®Œå…¨ã«ç‹¬ç«‹ã—ãŸBOTã‚¢ã‚«ã‚¦ãƒ³ãƒˆ
- âœ… ç•°ãªã‚‹ã‚µãƒ¼ãƒãƒ¼ãƒ»ãƒãƒ£ãƒ³ãƒãƒ«ã§åŒæ™‚ã«å‹•ä½œå¯èƒ½
- âœ… 1ã¤ã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãŒã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ã¦ã‚‚ä»–ã«å½±éŸ¿ãªã—
- âœ… ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†ãŒæ˜ç¢º
- âœ… ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ãŒé«˜ã„

---

## ğŸ“¦ å‰ææ¡ä»¶

### å¿…è¦ãªã‚‚ã®

1. **Docker & Docker Compose**
   ```bash
   # ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª
   docker --version
   docker-compose --version
   ```

2. **Discord BOTã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆå„ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼åˆ†ï¼‰**
   - [Discord Developer Portal](https://discord.com/developers/applications) ã§ä½œæˆ
   - å¿…è¦ãªæ¨©é™:
     - Read Messages/View Channels
     - Send Messages
     - Read Message History
     - Add Reactions
     - Use Slash Commands
     - Mention Everyoneï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

3. **OpenRouter API Key ã¾ãŸã¯ OpenAI API Key**
   - [OpenRouter](https://openrouter.ai/) (æ¨å¥¨)
   - ã¾ãŸã¯ [OpenAI](https://platform.openai.com/)

---

## ğŸ› ï¸ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### 1. Discord BOTã®ä½œæˆ

å„ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã”ã¨ã«ç•°ãªã‚‹BOTã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚

#### Friendly Character BOT

1. [Discord Developer Portal](https://discord.com/developers/applications) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. `New Application` ã‚’ã‚¯ãƒªãƒƒã‚¯
3. åå‰: `UniversalAI-Friendly` (ä»»æ„)
4. `Bot` ã‚¿ãƒ–ã‹ã‚‰ BOT ã‚’ä½œæˆ
5. `TOKEN` ã‚’ã‚³ãƒ”ãƒ¼ â†’ `DISCORD_BOT_TOKEN_FRIENDLY` ã¨ã—ã¦ä¿å­˜

#### Professional Character BOT

1. åŒæ§˜ã«æ–°ã—ã„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆ
2. åå‰: `UniversalAI-Professional` (ä»»æ„)
3. `Bot` ã‚¿ãƒ–ã‹ã‚‰ BOT ã‚’ä½œæˆ
4. `TOKEN` ã‚’ã‚³ãƒ”ãƒ¼ â†’ `DISCORD_BOT_TOKEN_PROFESSIONAL` ã¨ã—ã¦ä¿å­˜

### 2. BOTã‚’ã‚µãƒ¼ãƒãƒ¼ã«æ‹›å¾…

å„BOTã‚’Discordã‚µãƒ¼ãƒãƒ¼ã«æ‹›å¾…ã—ã¾ã™ã€‚

```
https://discord.com/api/oauth2/authorize?client_id=YOUR_CLIENT_ID&permissions=274877958144&scope=bot
```

`YOUR_CLIENT_ID` ã‚’å„BOTã®Client IDã«ç½®ãæ›ãˆã¦ãã ã•ã„ã€‚

### 3. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

```bash
# env.example ã‚’ã‚³ãƒ”ãƒ¼
cp env.example env.local

# env.local ã‚’ç·¨é›†
nano env.local  # ã¾ãŸã¯ vim, code ãªã©
```

#### env.local ã®è¨­å®šä¾‹

```bash
# Friendly Character Bot Token
DISCORD_BOT_TOKEN_FRIENDLY=YOUR_FRIENDLY_BOT_TOKEN_HERE

# Professional Character Bot Token
DISCORD_BOT_TOKEN_PROFESSIONAL=YOUR_PROFESSIONAL_BOT_TOKEN_HERE

# OpenRouter API Key
OPENROUTER_API_KEY=YOUR_OPENROUTER_API_KEY_HERE

# ã‚ªãƒ—ã‚·ãƒ§ãƒ³: OpenAI API Key
# OPENAI_API_KEY=YOUR_OPENAI_API_KEY_HERE
```

### 4. è¨­å®šã®ç¢ºèª

```bash
# ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã®ç¢ºèª
ls -la
# ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹ã“ã¨ã‚’ç¢ºèª:
# - docker-compose.yml
# - Dockerfile
# - env.local
# - start-multi-bots.sh
```

---

## ğŸš€ èµ·å‹•æ–¹æ³•

### ç°¡å˜èµ·å‹•ï¼ˆæ¨å¥¨ï¼‰

```bash
# èµ·å‹•ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨
./start-multi-bots.sh
```

ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ä»¥ä¸‹ã‚’è‡ªå‹•çš„ã«å®Ÿè¡Œã—ã¾ã™:
1. ç’°å¢ƒå¤‰æ•°ã®ãƒã‚§ãƒƒã‚¯
2. ãƒ­ã‚°ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆ
3. Docker ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰
4. ã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹•

### æ‰‹å‹•èµ·å‹•

```bash
# 1. ãƒ­ã‚°ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ
mkdir -p logs/friendly logs/professional

# 2. æ—¢å­˜ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’åœæ­¢ï¼ˆå­˜åœ¨ã™ã‚‹å ´åˆï¼‰
docker-compose down

# 3. ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰
docker-compose build

# 4. ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•
docker-compose up -d
```

### èµ·å‹•ç¢ºèª

```bash
# ã‚³ãƒ³ãƒ†ãƒŠã®çŠ¶æ…‹ã‚’ç¢ºèª
docker-compose ps

# ãƒ­ã‚°ã‚’ç¢ºèª
docker-compose logs -f
```

æ­£å¸¸ã«èµ·å‹•ã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªè¡¨ç¤ºãŒå‡ºã¾ã™:

```
bot-friendly        | âœ… Universal Discord AI ã‚’åˆæœŸåŒ–ä¸­... (ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼: friendly)
bot-professional    | âœ… Universal Discord AI ã‚’åˆæœŸåŒ–ä¸­... (ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼: professional)
bot-friendly        | âœ… ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼BOTã‚’ä½œæˆã—ã¾ã—ãŸ: friendly
bot-professional    | âœ… ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼BOTã‚’ä½œæˆã—ã¾ã—ãŸ: professional
```

---

## ğŸ® ç®¡ç†ã‚³ãƒãƒ³ãƒ‰

### ãƒ­ã‚°ã®ç¢ºèª

```bash
# å…¨BOTã®ãƒ­ã‚°ã‚’è¡¨ç¤ºï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ï¼‰
docker-compose logs -f

# ç‰¹å®šã®BOTã®ãƒ­ã‚°ã®ã¿è¡¨ç¤º
docker-compose logs -f bot-friendly
docker-compose logs -f bot-professional

# ç›´è¿‘100è¡Œã®ãƒ­ã‚°ã‚’è¡¨ç¤º
docker-compose logs --tail=100
```

### BOTã®åœæ­¢

```bash
# å…¨BOTã‚’åœæ­¢
docker-compose down

# ç‰¹å®šã®BOTã®ã¿åœæ­¢
docker-compose stop bot-friendly
docker-compose stop bot-professional
```

### BOTã®å†èµ·å‹•

```bash
# å…¨BOTã‚’å†èµ·å‹•
docker-compose restart

# ç‰¹å®šã®BOTã®ã¿å†èµ·å‹•
docker-compose restart bot-friendly
docker-compose restart bot-professional
```

### BOTã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèª

```bash
# ã‚³ãƒ³ãƒ†ãƒŠã®çŠ¶æ…‹ç¢ºèª
docker-compose ps

# ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨çŠ¶æ³ã®ç¢ºèª
docker stats
```

### ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª

```bash
# Friendlyã®ãƒ­ã‚°
tail -f logs/friendly/discord_ai.log

# Professionalã®ãƒ­ã‚°
tail -f logs/professional/discord_ai.log
```

---

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### BOTãŒèµ·å‹•ã—ãªã„

#### 1. ç’°å¢ƒå¤‰æ•°ã®ç¢ºèª

```bash
# env.localãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèª
ls -la env.local

# ç’°å¢ƒå¤‰æ•°ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
source env.local
echo $DISCORD_BOT_TOKEN_FRIENDLY
echo $DISCORD_BOT_TOKEN_PROFESSIONAL
echo $OPENROUTER_API_KEY
```

#### 2. Dockerãƒ­ã‚°ã®ç¢ºèª

```bash
# ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèª
docker-compose logs bot-friendly | grep -i error
docker-compose logs bot-professional | grep -i error
```

#### 3. ã‚³ãƒ³ãƒ†ãƒŠã®å†ãƒ“ãƒ«ãƒ‰

```bash
# ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½¿ã‚ãšã«å†ãƒ“ãƒ«ãƒ‰
docker-compose build --no-cache
docker-compose up -d
```

### BOTãŒDiscordã«æ¥ç¶šã§ããªã„

#### ãƒˆãƒ¼ã‚¯ãƒ³ã®ç¢ºèª

```bash
# ãƒˆãƒ¼ã‚¯ãƒ³ã®å½¢å¼ç¢ºèªï¼ˆå®Ÿéš›ã®ãƒˆãƒ¼ã‚¯ãƒ³ã¯è¡¨ç¤ºã—ãªã„ï¼‰
source env.local
if [[ $DISCORD_BOT_TOKEN_FRIENDLY =~ ^[A-Za-z0-9_-]+\.[A-Za-z0-9_-]+\.[A-Za-z0-9_-]+$ ]]; then
    echo "âœ… FRIENDLY ãƒˆãƒ¼ã‚¯ãƒ³å½¢å¼OK"
else
    echo "âŒ FRIENDLY ãƒˆãƒ¼ã‚¯ãƒ³å½¢å¼ã‚¨ãƒ©ãƒ¼"
fi
```

#### ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ç¢ºèª

```bash
# Dockerãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ç¢ºèª
docker network ls | grep discord-ai-network

# ã‚³ãƒ³ãƒ†ãƒŠãŒãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
docker network inspect discord-ai-network
```

### 1ã¤ã®BOTã ã‘èµ·å‹•ã—ãŸã„

```bash
# Friendlyã®ã¿èµ·å‹•
docker-compose up -d bot-friendly

# Professionalã®ã¿èµ·å‹•
docker-compose up -d bot-professional
```

### ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¨­å®šã‚’å¤‰æ›´ã—ãŸã„

```bash
# 1. characters/ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†
nano characters/friendly.md

# 2. BOTã‚’å†èµ·å‹•ï¼ˆè¨­å®šãŒå†èª­ã¿è¾¼ã¿ã•ã‚Œã‚‹ï¼‰
docker-compose restart bot-friendly
```

### ãƒ¡ãƒ¢ãƒªä¸è¶³ã‚¨ãƒ©ãƒ¼

`docker-compose.yml` ã®ãƒªã‚½ãƒ¼ã‚¹åˆ¶é™ã‚’èª¿æ•´:

```yaml
deploy:
  resources:
    limits:
      memory: 2G  # 1G â†’ 2G ã«å¢—ã‚„ã™
      cpus: '1.0'  # 0.5 â†’ 1.0 ã«å¢—ã‚„ã™
```

### ãƒ­ã‚°ãŒå¤§ãããªã‚Šã™ãã‚‹

ãƒ­ã‚°ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®è¨­å®šã‚’èª¿æ•´:

```yaml
logging:
  driver: "json-file"
  options:
    max-size: "5m"   # 10m â†’ 5m ã«æ¸›ã‚‰ã™
    max-file: "2"    # 3 â†’ 2 ã«æ¸›ã‚‰ã™
```

---

## ğŸ“Š ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°

### ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨çŠ¶æ³ã®ç¢ºèª

```bash
# ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨çŠ¶æ³ã‚’è¡¨ç¤º
docker stats

# ç‰¹å®šã®ã‚³ãƒ³ãƒ†ãƒŠã®ã¿
docker stats discord-ai-friendly discord-ai-professional
```

### ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯

```bash
# ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã®çŠ¶æ…‹ç¢ºèª
docker-compose ps

# è©³ç´°ãªãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯æƒ…å ±
docker inspect discord-ai-friendly | grep -A 10 Health
```

---

## ğŸ”§ é«˜åº¦ãªè¨­å®š

### æ–°ã—ã„ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®è¿½åŠ 

1. **ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ**
   ```bash
   # characters/creative.md ã‚’ä½œæˆ
   cp characters/friendly.md characters/creative.md
   nano characters/creative.md
   ```

2. **docker-compose.yml ã«è¿½åŠ **
   ```yaml
   bot-creative:
     build:
       context: .
       dockerfile: Dockerfile
     container_name: discord-ai-creative
     restart: unless-stopped
     environment:
       - CHARACTER_NAME=creative
       - DISCORD_BOT_TOKEN=${DISCORD_BOT_TOKEN_CREATIVE}
       - OPENROUTER_API_KEY=${OPENROUTER_API_KEY}
     volumes:
       - ./config:/app/config:ro
       - ./characters:/app/characters:ro
       - ./logs/creative:/app/logs:rw
     networks:
       - discord-ai-network
   ```

3. **env.local ã«è¿½åŠ **
   ```bash
   DISCORD_BOT_TOKEN_CREATIVE=your_token_here
   ```

4. **èµ·å‹•**
   ```bash
   docker-compose up -d bot-creative
   ```

### æœ¬ç•ªç’°å¢ƒã§ã®æ¨å¥¨è¨­å®š

```yaml
# docker-compose.prod.yml
services:
  bot-friendly:
    restart: always  # unless-stopped â†’ always
    deploy:
      resources:
        limits:
          memory: 2G
          cpus: '1.0'
      restart_policy:
        condition: on-failure
        delay: 5s
        max_attempts: 3
    logging:
      driver: "json-file"
      options:
        max-size: "50m"
        max-file: "10"
```

èµ·å‹•:
```bash
docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d
```

---

## ğŸ“š å‚è€ƒæƒ…å ±

- [Docker Compose Documentation](https://docs.docker.com/compose/)
- [Discord.py Documentation](https://discordpy.readthedocs.io/)
- [OpenRouter API Documentation](https://openrouter.ai/docs)

---

## ğŸ’¡ Tips

1. **é–‹ç™ºç’°å¢ƒã§ã¯å˜ä¸€BOTã§ååˆ†**
   - `python src/bot_async.py` ã§ç›´æ¥èµ·å‹•
   - ç’°å¢ƒå¤‰æ•° `CHARACTER_NAME` ã§åˆ‡ã‚Šæ›¿ãˆå¯èƒ½

2. **æœ¬ç•ªç’°å¢ƒã§ã¯Docker Composeã‚’æ¨å¥¨**
   - å®‰å®šæ€§ãŒé«˜ã„
   - ãƒ­ã‚°ç®¡ç†ãŒå®¹æ˜“
   - è‡ªå‹•å†èµ·å‹•æ©Ÿèƒ½

3. **ãƒªã‚½ãƒ¼ã‚¹ç›£è¦–ã‚’å¿˜ã‚Œãšã«**
   ```bash
   # CPU/ãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡ã®å®šæœŸç¢ºèª
   watch -n 5 'docker stats --no-stream'
   ```

---

## ğŸ¤ ã‚µãƒãƒ¼ãƒˆ

å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆ:

1. ãƒ­ã‚°ã‚’ç¢ºèª: `docker-compose logs -f`
2. GitHub Issues ã§å ±å‘Š
3. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å†ç¢ºèª

---

**ä½œæˆæ—¥**: 2026å¹´1æœˆ2æ—¥  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0

